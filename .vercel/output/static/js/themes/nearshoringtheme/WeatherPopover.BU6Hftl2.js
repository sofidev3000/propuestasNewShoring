import{j as e}from"./chunks/jsx-runtime.7faW4zRM.js";import{r}from"./chunks/index.DhYZZe0J.js";const _=()=>new Promise((t,o)=>{window.navigator.geolocation?window.navigator.geolocation.getCurrentPosition(a=>t(a.coords),a=>o(a),{enableHighAccuracy:!0,maximumAge:0}):o("Geolocation is not supported by this browser.")}),M={0:"01",1:"02",2:"03",3:"04",45:"50",48:"50",51:"09",53:"09",55:"09",56:"09",57:"09",61:"10",63:"10",65:"10",66:"10",67:"10",71:"13",73:"13",75:"13",77:"13",80:"09",81:"09",82:"09",85:"13",86:"13",95:"11",96:"11",99:"11"},C=(t,o)=>{const a=o?"d":"n";return`https://openweathermap.org/img/wn/${M[t]||"02"}${a}@2x.png`},I=async(t,o)=>{try{let a;const c=await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${t}&longitude=${o}&localityLanguage=en`),{city:d}=await c.json();a=d;const n=await(await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${t}&longitude=${o}&current_weather=true&hourly=relativehumidity_2m,precipitation_probability,windspeed_180m&daily=temperature_2m_max,temperature_2m_min&timezone=auto`)).json(),i=n.current_weather,u=i.temperature||"17",l=i.weathercode||2,p=i.is_day!==void 0?i.is_day:!0,g=C(l,p),h=n.hourly.relativehumidity_2m[0]||"50",j=n.hourly.precipitation_probability[0]||"20",x=n.hourly.windspeed_180m[0]||"5",y=n.daily.temperature_2m_max[0]||"18",f=n.daily.temperature_2m_min[0]||"16";return{temperature:u,city:a,iconImage:g,humidity:`${h}%`,precipProbability:`${j}%`,windspeed:`${x}km/h`,temperatureMax:`${y}°C`,temperatureMin:`${f}°C`}}catch(a){return console.error("Error fetching weather data:",a),{error:"Failed to retrieve weather data"}}},$=()=>{const[t,o]=r.useState({temperature:null,city:"Ubicaión no disponible",iconImage:"https://openweathermap.org/img/wn/02d@2x.png",humidity:null,precipProbability:null,windspeed:null,temperatureMax:null,temperatureMin:null,error:null}),[a,c]=r.useState(!1),d=r.useRef(null),[w,n]=r.useState(new Date),[i,u]=r.useState(!1),[l,p]=r.useState(!1),[g,h]=r.useState(!1),[j,x]=r.useState(!1),y=()=>{c(!a)};r.useEffect(()=>{const s=m=>{d.current&&!d.current.contains(m.target)&&c(!1)};return document.addEventListener("mouseenter",s),()=>{document.removeEventListener("mouseleave",s)}},[]);const f=async()=>{try{const s=await _(),m=await I(s.latitude,s.longitude);u(!0),o(m)}catch(s){u(!1),console.error("Geolocation error fail:",s),s.code==1?l&&(h(!0),document.body.style.overflow="hidden"):s.code==2&&l&&(x(!0),setTimeout(()=>{x(!1)},1700)),p(!1),o(m=>({...m,error:"Error al obtener los datos del clima"}))}};r.useEffect(()=>{f()},[]),r.useEffect(()=>{l===!0&&f()},[l]),r.useEffect(()=>{const s=setInterval(()=>{n(new Date)},1e3);return()=>{clearInterval(s)}},[]);const b={weekday:"long",day:"numeric",month:"long"},v=w.toLocaleDateString("es-ES",b),N=w.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",second:"numeric",hour12:!0});return e.jsxs(e.Fragment,{children:[i?e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",className:"btn btn-primary flex flex-wrap items-center gap-4 *:text-[14px]  *:text-white  relative ",onClick:y,children:[e.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[e.jsx("img",{className:"weather-icon text-[--neutral-variant-color]   w-[29px]",src:t.iconImage,alt:"Weather Icon"}),e.jsxs("span",{className:"font-normal cursor-pointer text-white hover:text-[--guardsman-red-500]",children:[t.temperature," ",e.jsx("sup",{className:"text-[9.2px] text-[--guardsman-red-800] mr-3",children:"c"})," ",t.city]})]}),a&&e.jsxs("div",{ref:d,className:"popover w-[11rem] bg-[--background-glass] backdrop-blur-[19px] shadow-lg p-3 *:text-[#cdcdcd] *:text-left rounded-lg absolute top-11 right-[-69px] z-[90] flex-1",children:[e.jsx("span",{className:"flex",children:e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{className:"w-16 h-16",src:t.iconImage,alt:"Weather Icon"})})})}),e.jsxs("span",{className:"flex w-full items-center text-2xl text-left font-bold",children:[t.temperature,e.jsx("sup",{className:"m-0",children:"c"})]}),e.jsx("div",{className:"flex my-2",children:e.jsx("div",{className:"w-full",children:e.jsx("hr",{className:"border-[--guardsman-red-800]"})})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-location-dot",style:{color:"#ba0000"}}),e.jsxs("span",{children:["Prob. Precip: ",t.precipProbability]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-temperature-three-quarters",style:{color:"#ba0000"}}),e.jsxs("span",{children:["Humedad: ",t.humidity]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-droplet",style:{color:"#ba0000"}}),e.jsxs("span",{children:["Viento: ",t.windspeed]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-umbrella",style:{color:"#ba0000"}}),e.jsxs("span",{children:["Temp-Max: ",t.temperatureMax]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-temperature-arrow-down",style:{color:"#ba0000"}}),e.jsxs("span",{children:["Temp-Min: ",t.temperatureMin]})]})]})]}),"// ",e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("time",{className:"flex items-center",children:v})," ","- ",e.jsx("time",{className:"cursor-pointer",translate:"no",children:N})]})]}):e.jsxs("div",{className:"flex hover:cursor-pointer ",onClick:()=>{p(!0)},children:[e.jsx("svg",{version:"1.0",xmlns:"http://www.w3.org/2000/svg",width:"15px",height:"15px",viewBox:"0 0 512.000000 512.000000",preserveAspectRatio:"xMidYMid meet",children:e.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:"#ffffff",stroke:"none",children:e.jsx("path",{d:`M2400 5110 c-709 -64 -1316 -544 -1544 -1220 -150 -446 -115 -956 94
-1365 77 -151 1484 -2454 1520 -2487 53 -49 150 -47 197 4 17 18 600 972 1387
2271 165 273 239 462 287 737 18 99 18 420 0 530 -62 395 -234 733 -511 1010
-271 271 -605 444 -980 506 -110 18 -329 25 -450 14z m304 -905 c205 -36 358
-117 502 -267 217 -224 299 -528 224 -836 -129 -535 -725 -828 -1230 -607
-247 108 -424 312 -507 582 -24 79 -27 103 -27 243 0 140 3 164 27 243 48 157
122 281 233 391 209 210 491 301 778 251z`})})}),e.jsx("p",{className:"font-bold text-red-500 text-xs ml-1",children:"Mi ubicación"})]}),e.jsx("div",{id:"myModalWeather",className:"modal-weather",style:{display:g?"block":"none"},children:e.jsxs("div",{className:"modal-content-weather",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"font-bold text-xl mb-2 text-orange-600",children:"Algo a ocurrido!"}),e.jsx("p",{className:"text-3xl text-red-500 hover:cursor-pointer mb-0",onClick:()=>{h(!1),document.body.style.overflow="auto"},children:"×"})]}),e.jsx("p",{children:"No es posible acceder a tu ubicación."}),e.jsx("p",{children:"Al parecer esta bloquedo el permiso, es necesario habilitarlo y recargar la página para poder acceder."})]})}),e.jsx("div",{className:`alert-weather ${j?"alert-show":"alert-hide"}`,children:e.jsx("p",{children:"Información de ubicación no está disponible."})})]})};export{$ as default};
